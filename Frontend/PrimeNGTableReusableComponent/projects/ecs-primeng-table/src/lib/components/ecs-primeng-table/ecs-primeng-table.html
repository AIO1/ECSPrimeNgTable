<p-table #dt
    size="small" showGridlines stripedRows 
    sortMode="multiple"
    [resizableColumns]="true" columnResizeMode="expand"
    [reorderableColumns]="true"
    [scrollable]="true" [scrollHeight]="computeScrollHeight ? scrollHeight : ''"
    [columns]="columnsToShow" [value]="data" dataKey="rowID" 
    [lazy]="true" (onLazyLoad)="updateData($event)">

    <!-- LOGIC FOR DRAWING TABLE ACTIONS ABOVE THE HEADER -->
    <ng-template #caption>
        <div #headerContainer style="display: flex; justify-content: space-between; align-items: center;">
            <div style="display: flex; align-items: center; gap: 10px;">
                <!--CHOOSE COLUMNS TO SHOW-->
                <!--
                <div *ngIf="columnEditorShow">
                    <button pButton pRipple icon="pi pi-info" (click)="showColumnModal()"
                        pTooltip="Modify columns"
                        [showDelay]="700"
                        tooltipPosition="top">
                    </button>
                </div>
                -->

                <!--CLEAR SORTS AND FILTERS-->
                <!--
                <button *ngIf="showClearSorts" pButton pRipple icon="pi pi-sort-alt-slash" (click)="clearSorts(dt)" [disabled]="!hasToClearSorts(dt)"
                    pTooltip="Clear sorts"
                    [showDelay]="700"
                    tooltipPosition="top">
                </button>
                <button *ngIf="showClearFilters" pButton pRipple icon="pi pi-filter-slash" (click)="clearFilters(dt)" [disabled]="!hasToClearFilters(dt, globalSearchText)"
                    pTooltip="Clear filters"
                    [showDelay]="700"
                    tooltipPosition="top">
                </button>
                -->
            </div>

            <!--TABLE VIEWS-->
            <!--
            <div *ngIf="tableViewSaveAs !== enumTableViewSaveMode.noone && tableViewsFirstFetchDone===true && tableViewSaveKey !== ''" style="display: flex; align-items: center; gap: 10px;">
                <div class="p-inputgroup custom-inputgroup" 
                    style="display: flex; align-items: center;">
                    <div (click)="viewsModalShow=true; $event.stopPropagation();" style="cursor: pointer; display: flex; align-items: center; padding: 0 10px;">
                        <input
                            type="text"
                            pInputText
                            [value]="tableViewCurrentSelectedAlias ? tableViewCurrentSelectedAlias : '--- Select a view ---'"
                            readonly
                            style="background-color: transparent; border: none; flex-grow: 1; pointer-events: none;"
                            [style.font-style]="tableViewCurrentSelectedAlias ? 'normal' : 'italic'"/>
                    </div>
                    <div class="vertical-separator"></div>
                    <button pButton 
                        pTooltip="Apply view again"
                        tooltipPosition="top"
                        [showDelay]="700"
                        type="button" icon="pi pi-refresh" (click)="loadTableView()"
                        class="p-button custom-refresh-button" style="cursor: pointer; height: 100%; padding: 0;" [disabled]="!hasLoadView()">
                    </button>
                    <button pButton 
                        pTooltip="Reset table view to original"
                        tooltipPosition="top"
                        [showDelay]="700"
                        type="button" icon="pi pi-eraser" (click)="resetTableView()"
                        class="p-button custom-refresh-button" style="cursor: pointer; height: 100%; padding: 0;">
                    </button>
                </div>
            </div>
            -->
            <div style="display: flex; align-items: center; gap: 10px;">
                <!--GLOBAL FILTER-->
                <!--<span *ngIf="globalSearchEnabled" class="p-input-icon-left p-ml-auto" [ngClass]="{'p-input-icon-right': globalSearchText}" >
                    <i class="pi pi-search" style="pointer-events: none;"></i>
                    <input pInputText type="text" (input)="dt.filterGlobal($any($event.target).value, 'contains')" [maxlength]="globalSearchMaxLength" [placeholder]="globalSearchPlaceholder" [(ngModel)]="globalSearchText" [style]="{width: '220px'}"/>
                    <i *ngIf="globalSearchText" class="pi pi-times" style="cursor: pointer;" (click)="clearFilters(dt, true, true); $event.stopPropagation()"></i>
                </span>-->

                <!--EXPORT DATA-->
                <!--
                <button *ngIf="reportSourceURL && reportSourceURL.trim().length > 0" 
                    pButton pRipple icon="pi pi-file-excel" (click)="openExcelReport(); $event.stopPropagation();"
                    pTooltip="Export table to Excel"
                    [showDelay]="700"
                    tooltipPosition="top"></button>
                -->

                <!--REFRESH DATA-->
                @if (showRefreshData) {
                    <p-button
                        icon="pi pi-refresh"
                        (onClick)="updateData($event)"
                        pTooltip="Refresh data"
                        [showDelay]="700"
                        tooltipPosition="top"
                        styleClass="p-button-icon-only"
                    />
                }
                
                <!--HEADER ACTION BUTTONS-->
                <!--
                <td *ngIf="headerActionButtons.length > 0" style="display: flex; justify-content: center; align-items: center;">
                    <ng-container *ngFor="let button of headerActionButtons">
                        <button [disabled]="button.condition ? !button.condition(null) : false"
                                [pTooltip]="button.tooltip || ''" 
                                [tooltipDisabled]="!button.tooltip || button.tooltip.length === 0"
                                [showDelay]="700"
                                tooltipPosition="top"
                                pButton pRipple
                                [ngClass]="button.color"
                                [icon]="button.icon ? button.icon : ''" 
                                [label]="button.label ? button.label : ''" 
                                (click)="button.action && handleButtonsClick(button.action, null)"
                                style="margin-right: 10px;">
                        </button>
                    </ng-container>
                </td>
                -->
            </div>
        </div>
    </ng-template>

    <!-- LOGIC FOR DRAWING TABLE HEADERS -->
    <ng-template #header let-columns>
        <tr>
            @for (col of columns; track col.header) {
                <th>
                    {{ col.header }}
                </th>
            }
        </tr>
    </ng-template>

    <!-- LOGIC FOR DRAWING TABLE DATA WHEN THERE IS CONTENTS -->
    <ng-template #body let-rowData let-columns="columns"> 
        <tr>
            @for (col of columns; track col.header) {
                <td>
                    {{ rowData[col.field] }}
                </td>
            }
        </tr>
    </ng-template>

    <!-- LOGIC FOR DRAWING TABLE DATA WHEN THERE IS NO CONTENTS -->
    <ng-template #emptymessage>
        <tr>
            <td colspan="999">No data found.</td>
        </tr>
    </ng-template>

    <!-- LOGIC FOR DRAWING PAGINATION -->
    <ng-template #summary>
    </ng-template>
</p-table>


<!--
<p-table #dt
    size="small" showGridlines stripedRows 
    sortMode="multiple"
    [resizableColumns]="true" columnResizeMode="expand"
    [reorderableColumns]="true"
    [scrollable]="true" [scrollHeight]="computeScrollHeight ? scrollHeight : ''"
    [columns]="columnsToShow" [value]="data" dataKey="rowID" 
    [lazy]="true" (onLazyLoad)="updateData($event)">
</p-table>

-->